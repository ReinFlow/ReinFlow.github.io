<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReinFlow Website</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            }
        });
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0 auto;
            max-width: 900px;
            padding: 20px;
            background-color: #f9f9f9;
            color: #333;
        }
        h1 {
            font-size: 2.5em;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
        }
        h2 {
            font-size: 1.8em;
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 30px; /* Added for spacing below sections */
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        h3 {
            font-size: 1.4em;
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 20px; /* Increased for subsection spacing */
        }
        h4 {
            font-size: 1.2em;
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px; /* Added for subsection spacing */
        }
        p {
            font-size: 1.1em;
            margin: 10px 0;
        }
        section {
            margin-bottom: 40px; /* Added for spacing between sections */
        }
        .figure-container {
            margin: 10px 0;
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        .subfigure-row {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 1px;
        }
        .subfigure {
            flex: 0 0 24%;
            text-align: center;
            margin-bottom: 1px;
        }
        .subfigure-3 {
            flex: 0 0 32%;
            text-align: center;
            margin-bottom: 1px;
        }
        .subfigure-2 {
            flex: 0 0 49%;
            text-align: center;
            margin-bottom: 1px;
        }
        img {
            width: 600px;
            height: 400px;
            object-fit: contain;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
            display: block;
            margin: 0 auto;
        }
        .subfigure img {
            width: 100%;
            height: 200px;
            object-fit: contain;
        }
        .subfigure-3 img {
            width: 100%;
            height: 200px;
            object-fit: contain;
        }
        .subfigure-2 img {
            width: 100%;
            height: 200px;
            object-fit: contain;
        }
        .legend img {
            width: 600px;
            height: 100px;
            object-fit: contain;
        }
        img[alt="Legend44"] {
            height: 40%;
            width: 64%;
        }
        img[alt="Legend4"] {
            height: 50%;
            width: 80%;
        }
        img[alt="Legend3"] {
            height: 20%;
            width: 60%;
        }
        .caption {
            font-size: 0.95em;
            color: #555;
            text-align: left;
            margin-top: 1px;
        }
        .subfigure-caption {
            font-size: 0.9em;
            color: #555;
            margin-top: 1px;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .subfigure-row {
            margin-bottom: 2px !important;
        }
        .figure-container.legend {
            margin-top: 0px !important;
            margin-bottom: 0px !important;
            background: transparent !important;
            box-shadow: none !important;
            padding: 0 !important;
        }
        .figure-container.legend img[alt="Legend3"],
        .figure-container.legend img[alt="Legend4"] {
            margin: 0 !important;
            padding: 0 !important;
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            background: transparent !important;
            display: block;
            width: 100%;
            height: 40px;
            object-fit: contain;
        }
        .figure-container.legend img[alt="Legend44"] {
            margin: 0 !important;
            padding: 0 !important;
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            background: transparent !important;
            display: block;
            width: 1000%;
            height: 25px;
            object-fit: contain;
        }
        img[alt="schematic"] {
            width: 80%;
            height: auto;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Can Success Rate"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Square Success Rate"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Transport Success Rate"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Diffusion RL Baselines in Ant-v0"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Diffusion RL Baselines in Hopper-v2"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Diffusion RL Baselines in Walker2d-v2"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Diffusion RL Baselines in Walker2d-v2"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }

        .subfigure img,
        .subfigure-2 img {
            width: 100%;
            height: 140px;
            object-fit: contain;
        }
        .indented-paragraph {
            text-indent: 30px;
        }
        .subfigure-row {
        display: flex;
        justify-content: center;
        gap: 0; /* or set a small gap if desired */
        margin: 0;
        padding: 0;
        }
        .subfigure {
        flex: 0 0 24%;
        margin: 0;
        padding: 0;
        }
        .algorithm {
            margin-top: 1em;
            border: 2px solid black;
            padding: 1em;
        }
        .line-numbered {
            display: flex;
            margin-bottom: 0.5em;
        }
        .line-number {
            width: 3em;
            text-align: right;
            padding-right: 1em;
            color: gray;
        }
        .line-content {
            flex: 1;
        }
        .indent-1 { margin-left: 2em; }
        .indent-2 { margin-left: 4em; }
        .indent-3 { margin-left: 6em; }
        .math {
            margin: 0.5em 0;
        }
        .citation-box {
            background: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            padding: 20px;
            font-family: 'SFMono-Regular', 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #24292f;
            overflow-x: auto;
            white-space: pre-wrap;
        }
    </style>
    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
<h1>ReinFlow: Fine-tuning Flow Matching Policy with Online Reinforcement Learning</h1>
<div style="text-align:center; margin-top:12px;">
  <h3 style="display:inline-block; margin:0 0 8px 0; font-weight:600;">
    üíê Paper accepted at <span style="color:#dd2a06;">NeurIPS 2025</span>
  </h3>
  <p style="margin:8px 0 6px 0; font-size:1rem; color:#333;">
    <a href="https://tonghe-zhang.github.io/" target="_blank" rel="noopener noreferrer">Tonghe Zhang</a><sup>1</sup>,
    <a href="https://nicsefc.ee.tsinghua.edu.cn/people/ChaoYu" target="_blank" rel="noopener noreferrer">Chao Yu</a><sup>2</sup>,
    <a href="https://destiny000621.github.io/" target="_blank" rel="noopener noreferrer">Sichang Su</a><sup>3</sup>,
    <a href="https://nicsefc.ee.tsinghua.edu.cn/people/YuWang" target="_blank" rel="noopener noreferrer">Yu Wang</a><sup>2</sup>
  </p>

  <p style="margin:6px 0 0 0; font-size:0.95rem; color:#555;">
    <sup>1</sup> Carnegie Mellon University &nbsp;&nbsp;
    <sup>2</sup> Tsinghua University &nbsp;&nbsp;
    <sup>3</sup> University of Texas at Austin
  </p>
</div>
    
<!-- <p style="font-size: 1.4rem; color: #666; margin-bottom: 20px; text-align: center;">Paper accepted at <span style="color: #dd2a06; font-weight: 600;">NeurIPS 2025</span></p> -->
<div style="text-align: center; margin: 20px 0; display: flex; justify-content: center; gap: 16px; flex-wrap: wrap;">
<a href="https://github.com/ReinFlow/ReinFlow/tree/release/docs" 
    style="background-color: #000; color: white; 
    padding: 5px 16px; 
    border-radius: 20px; 
    text-decoration: none; 
    font-family: Arial, sans-serif; 
    font-size: 16px;
    display: inline-flex; 
    align-items: center; 
    justify-content: center;">
    <span style="font-size: 18px; margin-right: 10px;">üìÑ</span> Docs
</a>
<a href="https://arxiv.org/abs/2505.22094" 
    style="background-color: #000; color: white; 
    padding: 8px 16px; 
    border-radius: 20px; 
    text-decoration: none; 
    font-family: Arial, sans-serif; 
    font-size: 16px;
    display: inline-flex; 
    align-items: center; 
    justify-content: center;">
    <img src="https://arxiv.org/favicon.ico" 
        alt="arXiv" 
        style="height: 20px; width: 20px; margin-right: 10px; object-fit: contain;"> 
    Paper
</a>
<a href="https://neurips.cc/virtual/2025/poster/119473" 
    style="background-color: #000; color: white; 
    padding: 8px 16px; 
    border-radius: 20px; 
    text-decoration: none; 
    font-family: Arial, sans-serif; 
    font-size: 16px;
    display: inline-flex; 
    align-items: center; 
    justify-content: center;">
    <img src="https://neurips.cc/static/core/img/neurips-logo-new.svg" 
        alt="NeurIPS" 
        style="height: 20px; width: 20px; margin-right: 10px; object-fit: contain;"> 
    NeurIPS
</a>
<a href="https://github.com/ReinFlow/ReinFlow" 
    style="background-color: #000; color: white; 
    padding: 8px 16px; 
    border-radius: 20px; 
    text-decoration: none; 
    font-family: Arial, sans-serif; 
    font-size: 16px;
    display: inline-flex; 
    align-items: center; 
    justify-content: center;">
    <i class="fab fa-github" style="margin-right: 10px;"></i> 
    Code
</a>
<a href="https://huggingface.co/datasets/ReinFlow/ReinFlow-data-checkpoints-logs/blob/main/README.md" 
    style="background-color: #000; color: white; 
    padding: 8px 16px; 
    border-radius: 20px; 
    text-decoration: none; 
    font-family: Arial, sans-serif; 
    font-size: 16px;
    display: inline-flex; 
    align-items: center; 
    justify-content: center;">
    <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" 
        alt="HuggingFace" 
        style="height: 20px; width: 20px; margin-right: 10px; object-fit: contain;"> 
    Checkpoints
</a>
<a href="https://wandb.ai/reinflow/projects" 
    style="background-color: #000; color: white; 
    padding: 8px 16px; 
    border-radius: 20px; 
    text-decoration: none; 
    font-family: Arial, sans-serif; 
    font-size: 16px;
    display: inline-flex; 
    align-items: center; 
    justify-content: center;">
    <img src="https://wandb.ai/logo.svg" 
            alt="WandB" 
            style="height: 20px; width: 20px; margin-right: 10px; object-fit: contain;"> 
    Metrics
</a>
</div>
<div class="figure-container">
            <img src="figs/jpgs/ReinFlow.jpg" alt="schematic">
            <div class="caption">
                <ul>
                <p>Fine-tuning flow matching policy with ReinFlow involves these steps:</p>
                <li><b>1. Rollout</b>: The robot interacts with the environment online and gathers visual and proprioceptive observation. </li>
                <li><b>2. Extract Features</b>: A pre-trained policy backbone extracts visuomotor features and feeds them to the velocity field $v_\theta$, which guides the next action's changes.</li>
                <li><b>3. Add Noise</b>: The network $\sigma_{\theta^\prime}$ shares extracted features with the velocity net and outputs Gaussian noise to smooth the ODE path for likelihood evaluation. </li>
                <li><b>4. Co-train and Discard</b>: The network $\sigma_{\theta^\prime}$ co-trains with $v_\theta$ only during fine-tuning and is discarded afterward.</li>
                </ul>
            </div>
    </div>

<section id="facts-about-reinflow">
    <h2>What is ReinFlow?</h2>
    ReinFlow is a general online RL fine-tuning framework for diversee flow matching policies. It is...
    <ul style="list-style: none; padding-left: 0; font-family: Arial, sans-serif; max-width: 800px;">
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">üåê</span>
            <strong>Purely Online:</strong> ReinFlow operates entirely online, enabling real-time interaction and adaptation to dynamic environments.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">üöÄ</span>
            <strong>Inborn Exploration:</strong> ReinFlow avoids constraints from pre-trained policies, fostering flexible and innovative exploration.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">üõ°Ô∏è</span>
            <strong>Stable:</strong> ReinFlow relaibly improves the reward of pre-trained checkpoints across diverse tasks and random seeds. 
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">‚ö°</span>
            <strong>One-Step or Few-Step Fine-Tuning:</strong> ReinFlow achieves effective fine-tuning with minimal denoising steps, 
            prioritizing wall-time efficiency at fine-tuning and deployment.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">üîÑ</span>
            <strong>Versatile:</strong> ReinFlow supports multiple flow model variants, such as Rectified Flow with various time distributions, 
            and Shortcut Models.         
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">üìò</span>
            <strong>Theoretically Grounded:</strong> ReinFlow‚Äôs gradient loss is derived from policy gradient theory for POMDPs, ensuring a solid theoretical foundation.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">üß†</span>
            <strong>General Framework:</strong> The algorithm adapts to all pre-trained policies with an ODE path with diverse policy gradient methods.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">üìÇ</span>
            <strong>Reproduceable:</strong> We open-source all the training script, hyperparameters, pre-training data, model checkpoints, and training records under the MIT license. 
        </li>
    </ul>
</section>



<section id="how-reinflow-works">
    <h2>How ReinFlow Works</h2>
    <ul style="list-style: none; padding-left: 0; font-family: Arial, sans-serif; max-width: 800px;">
        <li style="margin-bottom: 12px;">
            <strong>Routine</strong>
            <ul style="list-style: disc; padding-left: 20px;">
    <li>
    We provide a pseudocode of fine-tuning flow matching policy with ReinFlow. 
    <!-- <details> -->
        <!-- <summary style="cursor: pointer; color: blue; text-decoration: underline;">
            Click here to see the whole algorithm pseudocode.
        </summary> -->
        <div class="algorithm" id="alg-ReinFlow">
            <div class="caption">ReinFlow</div>
            <div class="line-numbered"><span class="line-number">1</span><span class="line-content"><b>Input:</b> pre-trained flow's velocity \(v_\theta\), denoising step \(K\), discount \(\gamma\), batch size \(B\), discretization scheme \(0 = t_0 < t_1 < \ldots < t_K = 1\) with \(\Delta t_k := t_{k+1} - t_k\), regularizor \(\mathcal{R}\) with intensity \(\alpha \in \mathbb{R}\).</span></div>
            <div class="line-numbered"><span class="line-number">2</span><span class="line-content">While not converged:</span></div>
            <div class="line-numbered"><span class="line-number">3</span><span class="line-content indent-1">Restore \(\bar{\theta}_{\mathrm{old}} \leftarrow \mathrm{stop\_grad}([\theta, \theta'])\).</span></div>
            <div class="line-numbered"><span class="line-number">4</span><span class="line-content indent-1">Reset env, receive observation \(o\).</span></div>
            <div class="line-numbered"><span class="line-number">5</span><span class="line-content indent-1">While not done:</span></div>
            <div class="line-numbered"><span class="line-number">6</span><span class="line-content indent-2">Sample \(a^0 \sim \mathcal{N}(0, \mathbb{I}_{d_A})\).</span></div>
            <div class="line-numbered"><span class="line-number">7</span><span class="line-content indent-2">For denoising step \(k \in \{0, 1, \ldots, K-1\}\):</span></div>
            <div class="line-numbered"><span class="line-number">8</span><span class="line-content indent-3">\(a^{k+1} \leftarrow a^k + v_\theta(t_k, a^k, o) \Delta t_k + {\color{purple}{\sigma_{\theta'}(t_k, a^k, o)}} \epsilon\), where \(\epsilon \sim \mathcal{N}(0, \mathbb{I}_{d_A})\).</span></div>
            <div class="line-numbered"><span class="line-number">9</span><span class="line-content indent-2">Play action \(a = a^K\), receive reward \(r\) and done flag \(d\), update observation \(o\).</span></div>
            <div class="line-numbered"><span class="line-number">10</span><span class="line-content indent-2">Store \(\{\mathbf{a}, o, r, d\}\) to buffer, where \(\mathbf{a} := (a^0, a^1, \ldots, a^K)\).</span></div>
            <div class="line-numbered"><span class="line-number">11</span><span class="line-content indent-1">Sample \(\{\mathbf{a}_i, o_i, r_i, d_i\}_{i=1}^B\) from buffer.</span></div>
            <div class="line-numbered"><span class="line-number">12</span><span class="line-content indent-1">Compute transition probability for all denoising step \(k\) and tuple \(i\):</span></div>
            <div class="line-numbered"><span class="line-number">13</span><span class="line-content indent-1"><div class="math">\[{\color{purple}{\ln \pi^{\bar{\theta}}\left(a_i^{k+1} | a_i^k, o_i\right)} = \ln \mathcal{N}\left(a_i^{k+1} \mid a_i^k + v_\theta(t_k, a_i^k, o_i) \Delta t_k\ , \ {\color{purple}{\sigma_{\theta'}^2(t_k, a_i^k, o_i)}}\right)}\]</div></span></div>
            <div class="line-numbered"><span class="line-number">14</span><span class="line-content indent-1">Estimate advantage \(A^{\bar{\theta}_{\mathrm{old}}}\) by a sub-routine and 
                jointly optimize \(\theta\) and \(\theta'\) by</span></div>
            <div class="line-numbered"><span class="line-number">15</span><span class="line-content indent-1"><div class="math">\[\begin{aligned}\theta, \theta' = \underset{\theta, \theta'}{\mathrm{argmin}} \frac{1}{B} \sum_{i=1}^B \Big[ & -A^{\bar{\theta}_{\mathrm{old}}}(o_i, a_i) {\color{purple}{\sum_{k=0}^{K-1} \ln \pi^{\bar{\theta}}\left(a_i^{k+1} | a_i^k, o_i\right)}} + \alpha \cdot \mathcal{R}\left(\mathbf{a}_i, o_i; \bar{\theta}, \bar{\theta}_{\mathrm{old}}\right) \Big]\end{aligned}\]</div>where \(\bar{\theta} := [\theta, \theta']\).</span></div>
            <div class="line-numbered"><span class="line-number">16</span><span class="line-content"><b>Return:</b> fine-tuned flow policy's velocity \(v_\theta\).</span></div>
        </div>
    <!-- </details> -->
    </li>
    <br>
    </ul>
        <strong>Structure of the Noise:</strong>
        <ul style="list-style: disc; padding-left: 20px;">
                <li><strong>Zero-mean:</strong> The noise injected is a magnitude-modulated centered Gaussian noise, matching the dimensions of the actions.</li>
                <li><strong>Bounded:</strong> 
                    <ul style="list-style: circle; padding-left: 20px;">
                        <li>Bounded noise is adopted to avoid exceeding physical constraints (too large) or limiting exploration (too small).</li>
                        <li>Implementation: Noise net output is squeezed through a tanh function, then scaled and shifted to a desired region.</li>
                        <li>Upper and lower bounds are hyperparameters relevant to the robot embodiment.</li>
                        <li>During fine-tuning, the noise net searches within these bounds and naturally decays as the policy converges to a high success rate.</li>
                        <li>Entropy regularization may increase noise to promote exploration.</li>
                    </ul>
                </li>
                <li><strong>Learnable:</strong> Conditioning noise on denoising time, denoised action, and observation improves performance, with minimal parameter increase during fine-tuning (compared to constant noise).</li>
                <li><strong>Markovian:</strong> Noise depends only on the current denoised action, not previous ones, ensuring the joint probability expands into the sum of transition probabilities.</li>
            </ul>
        </li>
        <li style="margin-bottom: 12px;">
            <strong>Parameter Efficiency:</strong> The noise network shares features with the velocity head, increasing success rate with minimal parameter increase during fine-tuning.
        </li>
        <li style="margin-bottom: 12px;">
            <strong>After Fine-Tuning:</strong> The noise network is discarded, and the fine-tuned model uses ODE inference for fast generation.
        </li>
    </ul>
</section>


<section id="experiments">
    <h2>Experiments</h2>
        <ul style="list-style: none; padding-left: 0; font-family: Arial, sans-serif; max-width: 800px;">
            <li style="margin-bottom: 12px;">
                üéØ <strong>Goal:</strong> Increase success rate for pre-trained flow policies at minimal denoising steps
            </li>
            <li style="margin-bottom: 12px;">
                ‚è±Ô∏è <strong>Focus:</strong> Wall time efficiency for simulated tasks
            </li>
            <li>
                üìä <strong>Baselines:</strong> DPPO, FQL, Gaussian, etc. (see Appendix for more)
            </li>
        </ul>
    </section>
    <section id="env-setup">
    <h3>1. Environment and Data</h3>
    <table style="width: 100%; border-collapse: collapse; text-align: left;">
        <thead>
        <tr>
            <th style="border-bottom: 2px solid #333; padding: 8px;">Input Type</th>
            <th style="border-bottom: 2px solid #333; padding: 8px;">Reward Type</th>
            <th style="border-bottom: 2px solid #333; padding: 8px;">Environment</th>
            <th style="border-bottom: 2px solid #333; padding: 8px;">Data Source</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td style="padding: 8px;">State</td>
            <td style="padding: 8px;">Dense</td>
            <td style="padding: 8px;">OpenAI Gym</td>
            <td style="padding: 8px;">D4RL data</td>
        </tr>
        <tr>
            <td style="padding: 8px;">State</td>
            <td style="padding: 8px;">Sparse</td>
            <td style="padding: 8px;">Franka Kitchen</td>
            <td style="padding: 8px;">Human-teleoperated data from D4RL</td>
        </tr>
        <tr>
            <td style="padding: 8px;">Visual</td>
            <td style="padding: 8px;">Sparse</td>
            <td style="padding: 8px;">Robomimic</td>
            <td style="padding: 8px;">Human-teleoperated data processed like DPPO's paper</td>
        </tr>
        </tbody>
    </table>

    <div style="margin-top: 20px; text-align: center;">
        <button id="toggleButton" onclick="toggleTaskImages()" style="font-size: 1em; padding: 8px 16px; cursor: pointer;">
        Click Here to Show specific tasks
        </button>
    </div>

        <div id="task-images" style="display: none; margin-top: 20px;">
        <div class="figure-container" style="text-align: center;">
        <div class="subfigure-row" style="justify-content: center; margin: 0; padding: 0;">
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="hopper-img" src="./figs/jpgs/Hopper-page1.jpg" alt="Hopper"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(A) Hopper</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="walker2d-img" src="./figs/jpgs/Walker2d-page1.jpg" alt="Walker2d"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(B) Walker2d</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="ant-img" src="./figs/jpgs/Ant-page1.jpg" alt="Ant"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(C) Ant</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="humanoid-img" src="./figs/jpgs/Humanoid-page1.jpg" alt="Humanoid"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(D) Humanoid</div>
            </div>
        </div>
        <div class="caption" style="text-align: center; margin-top: 8px;">
            OpenAI Gym locomotion tasks: Hopper, Walker2d, Ant, and Humanoid.
        </div>
        </div>

        <div class="figure-container" style="text-align: center; margin-top: 30px;">
        <div class="subfigure-row" style="justify-content: center; margin: 0; padding: 0;">
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="kitchen-img" src="./figs/jpgs/kitchen-page1.jpg" alt="Franka Kitchen"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(A) Franka Kitchen</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="can-img" src="./figs/jpgs/can-page1.jpg" alt="PickPlaceCan"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(B) PickPlaceCan</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="square-img" src="./figs/jpgs/square-page1.jpg" alt="NutAssemblySquare"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(C) NutAssemblySquare</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="transport-img" src="./figs/jpgs/transport-page1.jpg" alt="TwoArmTransport"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(D) TwoArmTransport</div>
            </div>
        </div>
        <div class="caption" style="text-align: center; margin-top: 8px;">
            Manipulation tasks in state-input Franka Kitchen and pixel-input Robomimic environments.
        </div>
        </div>
    </div>

    <script>
        function toggleTaskImages() {
        const taskImages = document.getElementById('task-images');
        const toggleButton = document.getElementById('toggleButton');
        if (taskImages.style.display === 'none') {
            taskImages.style.display = 'block';
            toggleButton.textContent = 'Click Here to Hide Specific Tasks';
        } else {
            taskImages.style.display = 'none';
            toggleButton.textContent = 'Click Here to Show specific tasks';
        }
        }
    </script>
    </section>

    <section id="performance-evaluation">
        <h3>2. Performance Evaluation and Comparisons</h3>
        <h4>2.1 Comparison with DPPO and FQL</h4>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">üìà</span>
            ReinFlow consistently enhances performance across Gym and Franka Kitchen benchmarks, boosting success rates by 40.09% in Robomimic tasks with fewer steps than DPPO.
        </p>
        <div class="figure-container" style="text-align: center;">
            <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/gym-state_hopper-d4rl_AverageEpisodeReward_wallclock-page1.jpg" alt="Hopper-v2 Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(A) Hopper-v2</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/gym-state_walker-d4rl_AverageEpisodeReward_wallclock-page1.jpg" alt="Walker-v2 Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(B) Walker-v2</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/gym-state_ant-d4rl_AverageEpisodeReward_wallclock-page1.jpg" alt="Ant-v2 Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(C) Ant-v2</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/gym-state_humanoid-d4rl_AverageEpisodeReward_wallclock-page1.jpg" alt="Humanoid-v3 Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(D) Humanoid-v3</div>
                </div>
            </div>
            <div class="figure-container legend" style="text-align: center;">
                <img src="figs/jpgs/gym-state_hopper-d4rl_AverageEpisodeReward_legend_crop-page1.jpg" alt="Legend44">
            </div>
            <div class="caption" style="text-align: center;">
                Wall time efficiency results of state-based locomotion tasks in OpenAI Gym. Dashed lines indicate the behavior cloning level.
            </div>
        </div>
        <div class="figure-container" style="text-align: center;">
            <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/kitchen_kitchen-complete-v0_TaskCompletionRate_wallclock-page1.jpg" alt="Kitchen-complete Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(A) Kitchen-complete</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/kitchen_kitchen-complete-v0_TaskCompletionRate-page1.jpg" alt="Kitchen-complete Sample">
                    <div class="subfigure-caption" style="text-align: center;">(B) Kitchen-complete</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/kitchen_kitchen-mixed-v0_TaskCompletionRate-page1.jpg" alt="Kitchen-mixed Sample">
                    <div class="subfigure-caption" style="text-align: center;">(C) Kitchen-mixed</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/kitchen_kitchen-partial-v0_TaskCompletionRate-page1.jpg" alt="Kitchen-partial Sample">
                    <div class="subfigure-caption" style="text-align: center;">(D) Kitchen-partial</div>
                </div>
            </div>
            <div class="figure-container legend" style="text-align: center;">
                <img src="figs/jpgs/kitchen_kitchen-complete-v0_TaskCompletionRate_legend_crop-page1.jpg" alt="Legend3">
            </div>
            <div class="caption" style="text-align: center;">
                Task completion rates of state-input manipulation tasks in Franka Kitchen. (A) and (B) show the completion rates against the wall time and sample cost. We only show the sample cost plots for agents trained on mixed and partial datasets for brevity.
            </div>
        </div>
        <div class="figure-container" style="text-align: center;">
            <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/robomimic-img_can-img_SuccessRate-page1.jpg" alt="Can Success Rate">
                    <div class="subfigure-caption" style="text-align: center;">(A) Can</div>
                </div>
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/robomimic-img_square-img_SuccessRate-page1.jpg" alt="Square Success Rate">
                    <div class="subfigure-caption" style="text-align: center;">(B) Square</div>
                </div>
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/robomimic-img_transport-img_SuccessRate-page1.jpg" alt="Transport Success Rate">
                    <div class="subfigure-caption" style="text-align: center;">(C) Transport</div>
                </div>
            </div>
            <div class="figure-container legend" style="text-align: center;">
                <img src="figs/jpgs/robomimic-img_can-img_SuccessRate_legend_crop-page1.jpg" alt="Legend4">
            </div>
            <div class="caption" style="text-align: center;">
                Success rates in visual manipulation tasks in Robomimic.
            </div>
        </div>

        <h4>2.2 Comparison with Other Diffusion RL Methods</h4>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">‚öñÔ∏è</span>
            ReinFlow outperforms diffusion RL baselines in stability and asymptotic performance across continuous control tasks like Ant-v0, Hopper-v2, and Walker2d-v2.
        </p>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">üìä</span>
            Using consistent hyperparameters from prior work, ReinFlow demonstrates superior performance, as shown in Fig. 5(A-C).
        </p>
        <div class="figure-container" style="text-align: center;">
            <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/all_diffusion_baselines_ant-page1.jpg" alt="Diffusion RL Baselines in Ant-v0">
                    <div class="subfigure-caption" style="text-align: center;">(A) Ant-v0</div>
                </div>
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/all_diffusion_baselines_hopper-page1.jpg" alt="Diffusion RL Baselines in Hopper-v2">
                    <div class="subfigure-caption" style="text-align: center;">(B) Hopper-v2</div>
                </div>
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/all_diffusion_baselines_walker-page1.jpg" alt="Diffusion RL Baselines in Walker2d-v2">
                    <div class="subfigure-caption" style="text-align: center;">(C) Walker2d-v2</div>
                </div>
            </div>
            <div class="caption" style="text-align: center;">
                Fine-tuning locomotion tasks Ant-v0, Hopper-v2, and Walker2d-v2 with Diffusion RL baselines and ReinFlow.
            </div>
        </div>
    </section>

    <section id="design-choice">
        <h3>3. The Design Choice and Key Factors Affecting ReinFlow</h3>
        <p>We examine how pre-trained models, denoising steps, noise levels, regularization and denoising step number impact ReinFlow.</p>
        <h4>3.1 RL Provides Another Scaling Dimension</h4>
        <p class="indented-paragraph" style="font-family: Arial, sans-serif; max-width: 800px; line-height: 1.4;">
            <span style="font-size: 1.2em; margin-right: 6px;">‚ûñ </span>
            Scaling data or inference steps: quickly plateaus.<br>
        </p>
        <p class="indented-paragraph">
            <span style="font-size: 1.2em; margin-right: 6px;">üìà</span>
            Fine-tuning with RL (ReinFlow): consistently enhances performance. 
        </p>
        <div class="figure-container">
            <div class="subfigure-row">
                <div class="subfigure-3">
                    <img src="figs/jpgs/avg_episode_reward_3d_surface-page1.jpg" alt="ReFlow Policy in Hopper-v2">
                    <div class="subfigure-caption">(A) ReFlow Policy in Hopper-v2</div>
                </div>
                <div class="subfigure-3">
                    <img src="figs/jpgs/datascale_shortcut_square_success_rate_2d-page1.jpg" alt="Shortcut Policy in Square">
                    <div class="subfigure-caption">(B) Shortcut Policy in Square</div>
                </div>
                <div class="subfigure-3">
                    <img src="figs/jpgs/robomimic-img_square-img-logitbeta_SuccessRate-page1.jpg" alt="ReFlow Policy in Square">
                    <div class="subfigure-caption">(C) ReFlow Policy in Square</div>
                </div>
            </div>
            <div class="caption">
                RL provides another way of scaling apart from increasing pre-training data and inference consumption, which has a plateauing effect. The improvement is invariant of flow policy‚Äôs time distribution and is achievable at four steps in Hopper (A) and one step in Square (B, C).
            </div>
        </div>
        <h4>3.2 Flow Matching's Time Distribution</h4>
        <p>ReinFlow's performance is robust to changes in time sampling. </p>
        <p class="indented-paragraph">‚úÖ Uniform </p>
        <p class="indented-paragraph">‚úÖ Logit-normal </p>
        <p class="indented-paragraph">‚úÖ Beta (slightly better for single-step fine-tuning.)</p>
        <h4>3.3 Noise Network Inputs</h4>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;" aria-hidden="true">üòä</span>
            Conditioning noise on state alone works well.
        </p>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
            <span style="font-size: 1.3em; margin-right: 8px;" aria-hidden="true">üòÑ</span>
            Conditioning noise on both state and time generates more diverse actions and improves success rates.
        </p>
        <div class="figure-container">
            <div class="subfigure-row">
                <div class="subfigure-2">
                    <img src="figs/jpgs/noise_parameterization_ant-page1.jpg" alt="Noise Input's Effect in Ant-v0">
                    <div class="subfigure-caption">(A) Noise Input's Effect in Ant-v0</div>
                </div>
                <div class="subfigure-2">
                    <img src="figs/jpgs/kitchen_kitchen-partial-v0-sigma_s_t_SuccessRate.jpg" alt="Noise Condition's Effect in Kitchen-partial">
                    <div class="subfigure-caption">(B) Noise Condition's Effect in Kitchen-partial-v0</div>
                </div>
            </div>
            <div class="caption">
                Conditioning on state and time yields a higher success rate than only conditioning on states.
            </div>
        </div>
        <h4>3.4 Noise Level and Exploration</h4>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">‚öñÔ∏è</span>
            Noise magnitude affects exploration: too little traps the policy, too much hurts execution.
        </p>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">üöÄ</span>
            Optimal noise levels enable significant gains, especially in complex tasks.
        </p>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">üîí</span>
            Policies become less sensitive to noise once in the correct region.
        </p>
        <h4>3.5 Regularization and Exploration</h4>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">üèÖ</span>
            Entropy regularization promotes exploration, while behavior cloning regularization can trap the policy and is unnecessary.
        </p>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">üèÖ</span>
            Entropy regularization outperforms Wasserstein-2 constraints used in offline RL methods like FQL.
        </p>
        <div class="figure-container">
            <div class="subfigure-row">
                <div class="subfigure-2">
                    <img src="figs/jpgs/constant_noise_level-page1.jpg" alt="Noise Level Affects Exploration in Ant-v0">
                    <div class="subfigure-caption">(A) Noise Level Affects Exploration in Ant-v0</div>
                </div>
                <div class="subfigure-2">
                    <img src="figs/jpgs/gym-state_humanoid-regularize-compare_AverageEpisodeReward-page1.jpg" alt="Regularization Affects ReinFlow in Humanoid-v3">
                    <div class="subfigure-caption">(B) Regularization Affects ReinFlow in Humanoid-v3</div>
                </div>
            </div>
            <div class="caption">
                Noise level and regularization's effect. (A) demonstrates constant noise with different standard deviation affects ReinFlow's exploration. (B) shows how entropy regularization with coefficient $\alpha$ and $W_2$ regularization with different coefficients $\beta$ influences ReinFlow.
            </div>
        </div>
        <h4>3.6 The Number of Denoising Steps</h4>
            <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
                <span style="font-size: 1.3em; margin-right: 8px;">üìà</span>
                Increasing the number of denoising steps $K$ in ReinFlow boosts initial rewards in Franka Kitchen‚Äôs Shortcut Policy but results in rapid reward plateaus, as shown in Fig. 4(A).
            </p>
            <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
                <span style="font-size: 1.3em; margin-right: 8px;">üéØ</span>
                In visual manipulation tasks, lowering noise standard deviation with higher $K$ improves performance for pre-trained policies with low success rates.
            </p>
            <div class="figure-container" style="text-align: center;">
                <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                    <div class="subfigure-2" style="max-width: 80%;">
                        <img src="figs/jpgs/kitchen_kitchen-complete-v0-denoise_step_TaskCompletionRate-page1.jpg" alt="Denoising Steps in Kitchen-complete">
                        <div class="subfigure-caption" style="text-align: center;">(A) Denoising Steps in Kitchen-complete</div>
                    </div>
                </div>
                <div class="caption" style="text-align: center;">
                    Fine-tuning Shortcut Policy in Kitchen-complete-v0 at denoising steps $K=1,2,4$, averaged over three seeds (0, 42, 3407).
                </div>
            </div>
        </section>
        </section>
    </section>


    
<section id="common-questions-reinflow">
    <h2>Common Questions about ReinFlow</h2>
    <ul style="list-style: none; padding-left: 0; font-family: Arial, sans-serif; max-width: 800px;">
        <li style="margin-bottom: 12px;">
            <strong>In which space is the noise added, and what does it mean physically?</strong>
            <ul style="list-style: disc; padding-left: 20px;">
                <li>Noise is added in the virtual denoising process, not directly to the final (real) action.</li>
                <!-- <li>The noise matches the shape of joint torques.</li> -->
                <li>Noise injection equates to slightly adjusting joint angles during action generation.</li>
                <li>Noises ultimately influence the real action deployed in the environment.</li>
            </ul>
        </li>
        <li style="margin-bottom: 12px;">
            <strong>Flow models have an exact probability expression, 
                why not use it directly?</strong>
            <ul style="list-style: disc; padding-left: 20px; font-family: Arial, sans-serif; max-width: 800px;">
        <li>Flow models' exact solution, 
            \[
            \ln p_1(\psi_1(x)) = \ln p_0(\psi_0(x)) - \int_0^1 \nabla \cdot v(t, \psi_t(x)) \, \mathrm{d}t, \quad x \sim p_0(\cdot),
            \]
            requires approximation in practice:
            \[
            \widehat{\ln p_1}(x_1) = \ln p_0(x_0) - \sum_{k=0}^{K-1} \mathrm{tr}\left[Z^\top \partial_X v_\theta(t_i, X_{t_i}) Z\right] \Delta t_i,
            \]
            where \( Z \sim p_Z(\cdot) \), \( \mathbb{E}[Z] = 0 \), \( \mathrm{Cov}[Z] = \mathbb{I}_{d\times d} \). This introduces Monte-Carlo noise and simulation errors.</li>
        <li>ReinFlow directly treats the inference as a discrete-time process, avoiding discretization errors and working with very few steps.</li>
        <li>ReinFlow adds bounded Gaussian noise, so the 
            statistics of denoised actions is simple to compute and fully known, 
            eliminating the Monte-Carlo errors in trace estimate. </li>
    </ul>
            <table style="width: 100%; border-collapse: collapse; margin-top: 10px; text-align: left;">
                <tr style="border-bottom: 1px solid #ddd;">
                    <td style="padding: 8px; font-style: italic;">Aspect</td>
                    <td style="padding: 8px; font-style: italic;">Na√Øve Approach (no noise injection)</td>
                    <td style="padding: 8px; font-style: italic;">ReinFlow</td>
                </tr>
                <tr style="border-bottom: 1px solid #ddd;">
                    <td style="padding: 8px;">Noise Type</td>
                    <td style="padding: 8px;">Directly compute log probability</td>
                    <td style="padding: 8px;">Inject learnable noise</td>
                </tr>
                <tr style="border-bottom: 1px solid #ddd;">
                    <td style="padding: 8px;">Error</td>
                    <td style="padding: 8px;">Unknown Monte-Carlo and discretization error</td>
                    <td style="padding: 8px;">Controllable and fully known Gaussian noise</td>
                </tr>
                <tr style="border-bottom: 1px solid #ddd;">
                    <td style="padding: 8px;">Accuracy</td>
                    <td style="padding: 8px;">Inaccurate at few steps</td>
                    <td style="padding: 8px;">No discretization concerns, accurate for 4, 2, or 1 steps</td>
                </tr>
                <tr style="border-bottom: 1px solid #ddd;">
                    <td style="padding: 8px;">Computation</td>
                    <td style="padding: 8px;">Compute-intensive in multiple steps</td>
                    <td style="padding: 8px;">Fast closed-form solution</td>
                </tr>
            </table>
        </li>
        <li style="margin-bottom: 12px;">
            <strong>Why add structured noise?</strong>
            <ul style="list-style: disc; padding-left: 20px;">
                <li>Smooths the ODE for a simple and exact likelihood expression, vital for reinforcement learning (RL).</li>
                <li>Enables controllable exploration during fine-tuning through pre-defined and adjustable bounds, as well as regularization.</li>
            </ul>
        </li>
        <li style="margin-bottom: 12px;">
            <strong>What is the ReinFlow related to ODE-SDE conversion?</strong> 
            When the denoising step count is large enough, 
            ReinFlow can be viewed as 
            augmenting the pre-trained flow ODE to a non-linear stochastic differential equation, which enhances generation diversity and exploration.
            <p style="text-align: center;">\[
            \begin{align}
                \text{SDE general form:}\ \ \qquad \ \ \mathrm{d}X_t &= \quad f(X_t, t) \ \ \  \mathrm{d}t \ \ 
                + \qquad {\color{purple}{
                    \sigma(X_t, t)
                }} \, \mathrm{d}W_t \\
                \text{ReinFlow's update:}\ \ a^{k+1} - a^k &=
                \underbrace{v_\theta(t_k, a^k, o) \Delta t_k}_\text{Drift}
                + 
                \underbrace{{\color{purple}{
                    \sigma_{\theta'}(t_k, a^k, o)
                }}\sqrt{\Delta t_k} \ \epsilon}_{\text{Diffusion}}
                , \quad \epsilon \sim \mathcal{N}(0, \mathbb{I}_{d_A})
            \end{align}
            \]
            </p>
            <p style="font-size: 0.9em; margin-top: 8px;"><sup>*</sup> Note: The \( \sqrt{\Delta t_k} \) term is omitted when using uniform discretization, as it is equivalent to scaling \( \sigma_{\theta'} \)'s output.</p>
            <span style="color: purple;">However, the analogy above is just one way to understand our approach, but now how it was invented.</span>
            Unlike methods that simulate a continuous-time stochastic differential equation (SDE), which need very small steps to avoid errors, ReinFlow models the flow policy as a discrete-time process during inference. This allows it to fine-tune with fewer denoising steps while still accurately evaluating probabilities.        </li>
        <li style="margin-bottom: 12px;">
            <strong>How does ReinFlow differ from diffusion?</strong>
            <ul style="list-style: disc; padding-left: 20px;">
                <li>ReinFlow still retains a deterministic component (the velocity) obtained from pre-training.</li>
                <li>Noise is introduced only during fine-tuning, recovers an ODE after fine-tuning.</li>
            </ul>
        </li>
    </ul>
</section>



<section id="citation">
        <h2>Cite our work</h2>
        <div class="citation-box">@misc{zhang2025reinflowfinetuningflowmatching,
       title={ReinFlow: Fine-tuning Flow Matching Policy with Online Reinforcement Learning},
       author={Tonghe Zhang and Chao Yu and Sichang Su and Yu Wang},
       year={2025},
       eprint={2505.22094},
       archivePrefix={arXiv},
       primaryClass={cs.RO},
       url={https://arxiv.org/abs/2505.22094},
}
</div>
</section>

</body>
</html>
