<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReinFlow Experiments</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            }
        });
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0 auto;
            max-width: 900px;
            padding: 20px;
            background-color: #f9f9f9;
            color: #333;
        }
        h1 {
            font-size: 2.5em;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
        }
        h2 {
            font-size: 1.8em;
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 30px; /* Added for spacing below sections */
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        h3 {
            font-size: 1.4em;
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 20px; /* Increased for subsection spacing */
        }
        h4 {
            font-size: 1.2em;
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px; /* Added for subsection spacing */
        }
        p {
            font-size: 1.1em;
            margin: 10px 0;
        }
        section {
            margin-bottom: 40px; /* Added for spacing between sections */
        }
        .figure-container {
            margin: 10px 0;
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        .subfigure-row {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 1px;
        }
        .subfigure {
            flex: 0 0 24%;
            text-align: center;
            margin-bottom: 1px;
        }
        .subfigure-3 {
            flex: 0 0 32%;
            text-align: center;
            margin-bottom: 1px;
        }
        .subfigure-2 {
            flex: 0 0 49%;
            text-align: center;
            margin-bottom: 1px;
        }
        img {
            width: 600px;
            height: 400px;
            object-fit: contain;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
            display: block;
            margin: 0 auto;
        }
        .subfigure img {
            width: 100%;
            height: 200px;
            object-fit: contain;
        }
        .subfigure-3 img {
            width: 100%;
            height: 200px;
            object-fit: contain;
        }
        .subfigure-2 img {
            width: 100%;
            height: 200px;
            object-fit: contain;
        }
        .legend img {
            width: 600px;
            height: 100px;
            object-fit: contain;
        }
        img[alt="Legend44"] {
            height: 40%;
            width: 64%;
        }
        img[alt="Legend4"] {
            height: 50%;
            width: 80%;
        }
        img[alt="Legend3"] {
            height: 20%;
            width: 60%;
        }
        .caption {
            font-size: 0.95em;
            color: #555;
            text-align: left;
            margin-top: 1px;
        }
        .subfigure-caption {
            font-size: 0.9em;
            color: #555;
            margin-top: 1px;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .subfigure-row {
            margin-bottom: 2px !important;
        }
        .figure-container.legend {
            margin-top: 0px !important;
            margin-bottom: 0px !important;
            background: transparent !important;
            box-shadow: none !important;
            padding: 0 !important;
        }
        .figure-container.legend img[alt="Legend3"],
        .figure-container.legend img[alt="Legend4"] {
            margin: 0 !important;
            padding: 0 !important;
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            background: transparent !important;
            display: block;
            width: 100%;
            height: 40px;
            object-fit: contain;
        }
        .figure-container.legend img[alt="Legend44"] {
            margin: 0 !important;
            padding: 0 !important;
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            background: transparent !important;
            display: block;
            width: 1000%;
            height: 25px;
            object-fit: contain;
        }
        img[alt="schematic"] {
            width: 80%;
            height: auto;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Can Success Rate"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Square Success Rate"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Transport Success Rate"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Diffusion RL Baselines in Ant-v0"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Diffusion RL Baselines in Hopper-v2"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Diffusion RL Baselines in Walker2d-v2"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }
        img[alt="Diffusion RL Baselines in Walker2d-v2"] {
            width: 90%;
            height: 120pt;
            display: block;
            margin: 0 auto;
            max-width: 800px;
        }

        .subfigure img,
        .subfigure-2 img {
            width: 100%;
            height: 140px;
            object-fit: contain;
        }
        .indented-paragraph {
            text-indent: 30px;
        }
        .subfigure-row {
        display: flex;
        justify-content: center;
        gap: 0; /* or set a small gap if desired */
        margin: 0;
        padding: 0;
        }
        .subfigure {
        flex: 0 0 24%;
        margin: 0;
        padding: 0;
        }
        
        
    </style>

<!-- Include arXiv icon if not already loaded -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
<h1>ReinFlow: Fine-tuning Flow Matching Policy with Online Reinforcement Learning</h1>
<div style="text-align: center; margin: 20px 0; display: flex; justify-content: center; gap: 16px; flex-wrap: wrap;">
  <a href="https://github.com/ReinFlow/ReinFlow" 
     style="background-color: #000; color: white; 
     padding: 8px 16px; 
     border-radius: 20px; 
     text-decoration: none; 
     font-family: Arial, sans-serif; 
     display: inline-flex; 
     align-items: center; 
     justify-content: center;">
    <i class="fab fa-github" style="margin-right: 10px;"></i> Code
  </a>
    <a href="https://github.com/ReinFlow/ReinFlow/tree/release/docs" 
        style="background-color: #000; color: white; 
        padding: 5px 16px; 
        border-radius: 20px; 
        text-decoration: none; 
        font-family: Arial, sans-serif; 
        display: inline-flex; 
        align-items: center; 
        justify-content: center;">
        <span style="font-size: 18px; margin-right: 10px;">📄</span> Docs
    </a>


  <!-- <a href="https://arxiv.org/abs/2505.22094" 
     style="background-color: #000; color: white; 
     padding: 8px 16px; 
     border-radius: 20px; 
     text-decoration: none; 
     font-family: Arial, sans-serif; 
     display: inline-flex; 
     align-items: center; 
     justify-content: center;">
    <span style="font-size: 18px; margin-right: 10px;">📄</span> Paper
  </a> -->

  <!-- <a href="#" 
     style="background-color: #000; color: white; 
     padding: 8px 16px; 
     border-radius: 20px; 
     text-decoration: none; 
     font-family: Arial, sans-serif; 
     display: inline-flex; 
     align-items: center; 
     justify-content: center;">
    <span style="font-size: 18px; margin-right: 10px;">🤗</span> Data
  </a> -->
</div>

<div class="figure-container">
        <img src="figs/jpgs/ReinFlow.jpg" alt="schematic">
        <div class="caption">
            <!-- <p>Fine-tuning Flow Matching Policy with ReinFlow. 
            Through interactions with the environment, the robot collects visual and proprioceptive signals, 
            from which a pre-trained policy extracts features and outputs the next action's velocity field $v_\theta$. 
            A noise injection network $\sigma_{\theta^\prime}$ shares the extracted features with $v_\theta$ and outputs a Gaussian noise that smoothens the flow's deterministic ODE path, converting flows to a discrete-time Markov process with Gaussian transition probabilities. 
            The noise injection yields a simple and exact likelihood expression at any denoising steps, which is friendly for policy gradient optimization. 
            The noise injection net $\sigma_{\theta^\prime}$, surrounded by the dot lines, is co-trained with $v_\theta$ but will be discarded after fine-tuning.</p> -->
            <ul>
            <p>Fine-tuning flow matching policy with ReinFlow involves these steps:</p>
            <!-- <ul> -->
            <li><b>1. Rollout</b>: The robot interacts with the environment online and gathers visual and proprioceptive observation. </li>
            <li><b>2. Extract Features</b>: A pre-trained policy backbone extracts visuomotor features and feeds them to the velocity field $v_\theta$, which guides the next action's changes.</li>
            <li><b>3. Add Noise</b>: The network $\sigma_{\theta^\prime}$ shares extracted features with the velocity net and outputs Gaussian noise to smooth the ODE path for likelihood evaluation. </li>
            <li><b>4. Co-train and Discard</b>: The network $\sigma_{\theta^\prime}$ co-trains with $v_\theta$ only during fine-tuning and is discarded afterward.</li>
            <!-- </ul>          -->
            </ul>
        </div>
</div>



<section id="facts-about-reinflow">
    <h2>Facts about ReinFlow</h2>
    ReinFlow is a general online RL fine-tuning framework for diversee flow matching policies. It is...
    <ul style="list-style: none; padding-left: 0; font-family: Arial, sans-serif; max-width: 800px;">
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">🌐</span>
            <strong>Purely Online:</strong> ReinFlow operates entirely online, enabling real-time interaction and adaptation to dynamic environments.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">🚀</span>
            <strong>Inborn Exploration:</strong> ReinFlow avoids constraints from pre-trained policies, fostering flexible and innovative exploration.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">🛡️</span>
            <strong>Stable:</strong> ReinFlow relaibly improves the reward of pre-trained checkpoints across diverse tasks and random seeds. 
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">⚡</span>
            <strong>One-Step or Few-Step Fine-Tuning:</strong> ReinFlow achieves effective fine-tuning with minimal denoising steps, 
            prioritizing wall-time efficiency at fine-tuning and deployment.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">🔄</span>
            <strong>Versatile:</strong> ReinFlow supports multiple flow model variants, such as Rectified Flow with various time distributions, 
            and Shortcut Models.         
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">📘</span>
            <strong>Theoretically Grounded:</strong> ReinFlow’s gradient loss is derived from policy gradient theory for POMDPs, ensuring a solid theoretical foundation.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">🧠</span>
            <strong>General Framework:</strong> The algorithm adapts to all pre-trained policies with an ODE path with diverse policy gradient methods.
        </li>
        <li style="margin-bottom: 12px;">
            <span style="font-size: 1.3em; margin-right: 8px;">📂</span>
            <strong>Reproduceable:</strong> We open-source all the training script, hyperparameters, pre-training data, model checkpoints, and training records under the MIT license. 
        </li>
    </ul>
</section>

    <section id="experiments">
        <h2>Experiments</h2>
        <ul style="list-style: none; padding-left: 0; font-family: Arial, sans-serif; max-width: 800px;">
            <li style="margin-bottom: 12px;">
                🎯 <strong>Goal:</strong> Increase success rate for pre-trained flow policies at minimal denoising steps
            </li>
            <li style="margin-bottom: 12px;">
                ⏱️ <strong>Focus:</strong> Wall time efficiency for simulated tasks
            </li>
            <li>
                📊 <strong>Baselines:</strong> DPPO, FQL, Gaussian, etc. (see Appendix for more)
            </li>
        </ul>
    </section>

    <!-- <section id="env-setup">
        <h3>1. Environment and Data</h3>
        <table style="width: 100%; border-collapse: collapse; text-align: left;">
            <thead>
            <tr>
                <th style="border-bottom: 2px solid #333; padding: 8px;">Input Type</th>
                <th style="border-bottom: 2px solid #333; padding: 8px;">Reward Type</th>
                <th style="border-bottom: 2px solid #333; padding: 8px;">Environment</th>
                <th style="border-bottom: 2px solid #333; padding: 8px;">Data Source</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td style="padding: 8px;">State</td>
                <td style="padding: 8px;">Dense</td>
                <td style="padding: 8px;">OpenAI Gym</td>
                <td style="padding: 8px;">D4RL data</td>
            </tr>
            <tr>
                <td style="padding: 8px;">State</td>
                <td style="padding: 8px;">Sparse<strong></strong></td>
                <td style="padding: 8px;">Franka Kitchen</td>
                <td style="padding: 8px;">Human-teleoperated data from D4RL</td>
            </tr>
            <tr>
                <td style="padding: 8px;">Visual<strong></strong></td>
                <td style="padding: 8px;">Sparse<strong></strong></td>
                <td style="padding: 8px;">Robomimic</td>
                <td style="padding: 8px;">Human-teleoperated data processed like DPPO's paper</td>
            </tr>
            </tbody>
        </table>
    </section> -->



    <section id="env-setup">
    <h3>1. Environment and Data</h3>
    <table style="width: 100%; border-collapse: collapse; text-align: left;">
        <thead>
        <tr>
            <th style="border-bottom: 2px solid #333; padding: 8px;">Input Type</th>
            <th style="border-bottom: 2px solid #333; padding: 8px;">Reward Type</th>
            <th style="border-bottom: 2px solid #333; padding: 8px;">Environment</th>
            <th style="border-bottom: 2px solid #333; padding: 8px;">Data Source</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td style="padding: 8px;">State</td>
            <td style="padding: 8px;">Dense</td>
            <td style="padding: 8px;">OpenAI Gym</td>
            <td style="padding: 8px;">D4RL data</td>
        </tr>
        <tr>
            <td style="padding: 8px;">State</td>
            <td style="padding: 8px;">Sparse</td>
            <td style="padding: 8px;">Franka Kitchen</td>
            <td style="padding: 8px;">Human-teleoperated data from D4RL</td>
        </tr>
        <tr>
            <td style="padding: 8px;">Visual</td>
            <td style="padding: 8px;">Sparse</td>
            <td style="padding: 8px;">Robomimic</td>
            <td style="padding: 8px;">Human-teleoperated data processed like DPPO's paper</td>
        </tr>
        </tbody>
    </table>

    <div style="margin-top: 20px; text-align: center;">
        <button id="toggleButton" onclick="toggleTaskImages()" style="font-size: 1em; padding: 8px 16px; cursor: pointer;">
        Click Here to Show specific tasks
        </button>
    </div>

        <div id="task-images" style="display: none; margin-top: 20px;">
        <div class="figure-container" style="text-align: center;">
        <div class="subfigure-row" style="justify-content: center; margin: 0; padding: 0;">
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="hopper-img" src="./figs/jpgs/Hopper-page1.jpg" alt="Hopper"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(A) Hopper</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="walker2d-img" src="./figs/jpgs/Walker2d-page1.jpg" alt="Walker2d"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(B) Walker2d</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="ant-img" src="./figs/jpgs/Ant-page1.jpg" alt="Ant"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(C) Ant</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="humanoid-img" src="./figs/jpgs/Humanoid-page1.jpg" alt="Humanoid"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(D) Humanoid</div>
            </div>
        </div>
        <div class="caption" style="text-align: center; margin-top: 8px;">
            OpenAI Gym locomotion tasks: Hopper, Walker2d, Ant, and Humanoid.
        </div>
        </div>

        <div class="figure-container" style="text-align: center; margin-top: 30px;">
        <div class="subfigure-row" style="justify-content: center; margin: 0; padding: 0;">
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="kitchen-img" src="./figs/jpgs/kitchen-page1.jpg" alt="Franka Kitchen"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(A) Franka Kitchen</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="can-img" src="./figs/jpgs/can-page1.jpg" alt="PickPlaceCan"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(B) PickPlaceCan</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="square-img" src="./figs/jpgs/square-page1.jpg" alt="NutAssemblySquare"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(C) NutAssemblySquare</div>
            </div>
            <div class="subfigure" style="max-width: 24%; display: inline-block; vertical-align: top; margin: 0; padding: 0;">
            <img id="transport-img" src="./figs/jpgs/transport-page1.jpg" alt="TwoArmTransport"
                style="width: 180px; height: 120px; margin: 0; padding: 0; object-fit: fill; display: block;">
            <div class="subfigure-caption" style="text-align: center; margin: 0;">(D) TwoArmTransport</div>
            </div>
        </div>
        <div class="caption" style="text-align: center; margin-top: 8px;">
            Manipulation tasks in state-input Franka Kitchen and pixel-input Robomimic environments.
        </div>
        </div>
    </div>

    <script>
        function toggleTaskImages() {
        const taskImages = document.getElementById('task-images');
        const toggleButton = document.getElementById('toggleButton');
        if (taskImages.style.display === 'none') {
            taskImages.style.display = 'block';
            toggleButton.textContent = 'Click Here to Hide Specific Tasks';
        } else {
            taskImages.style.display = 'none';
            toggleButton.textContent = 'Click Here to Show specific tasks';
        }
        }
    </script>
    </section>




    <section id="performance-evaluation">
        <h3>2. Performance Evaluation and Comparisons</h3>
        <h4>2.1 Comparison with DPPO and FQL</h4>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">📈</span>
            ReinFlow consistently enhances performance across Gym and Franka Kitchen benchmarks, boosting success rates by 40.09% in Robomimic tasks with fewer steps than DPPO.
        </p>
        <div class="figure-container" style="text-align: center;">
            <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/gym-state_hopper-d4rl_AverageEpisodeReward_wallclock-page1.jpg" alt="Hopper-v2 Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(A) Hopper-v2</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/gym-state_walker-d4rl_AverageEpisodeReward_wallclock-page1.jpg" alt="Walker-v2 Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(B) Walker-v2</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/gym-state_ant-d4rl_AverageEpisodeReward_wallclock-page1.jpg" alt="Ant-v2 Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(C) Ant-v2</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/gym-state_humanoid-d4rl_AverageEpisodeReward_wallclock-page1.jpg" alt="Humanoid-v3 Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(D) Humanoid-v3</div>
                </div>
            </div>
            <div class="figure-container legend" style="text-align: center;">
                <img src="figs/jpgs/gym-state_hopper-d4rl_AverageEpisodeReward_legend_crop-page1.jpg" alt="Legend44">
            </div>
            <div class="caption" style="text-align: center;">
                Wall time efficiency results of state-based locomotion tasks in OpenAI Gym. Dashed lines indicate the behavior cloning level.
            </div>
        </div>
        <div class="figure-container" style="text-align: center;">
            <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/kitchen_kitchen-complete-v0_TaskCompletionRate_wallclock-page1.jpg" alt="Kitchen-complete Wall Time">
                    <div class="subfigure-caption" style="text-align: center;">(A) Kitchen-complete</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/kitchen_kitchen-complete-v0_TaskCompletionRate-page1.jpg" alt="Kitchen-complete Sample">
                    <div class="subfigure-caption" style="text-align: center;">(B) Kitchen-complete</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/kitchen_kitchen-mixed-v0_TaskCompletionRate-page1.jpg" alt="Kitchen-mixed Sample">
                    <div class="subfigure-caption" style="text-align: center;">(C) Kitchen-mixed</div>
                </div>
                <div class="subfigure" style="max-width: 24%;">
                    <img src="figs/jpgs/kitchen_kitchen-partial-v0_TaskCompletionRate-page1.jpg" alt="Kitchen-partial Sample">
                    <div class="subfigure-caption" style="text-align: center;">(D) Kitchen-partial</div>
                </div>
            </div>
            <div class="figure-container legend" style="text-align: center;">
                <img src="figs/jpgs/kitchen_kitchen-complete-v0_TaskCompletionRate_legend_crop-page1.jpg" alt="Legend3">
            </div>
            <div class="caption" style="text-align: center;">
                Task completion rates of state-input manipulation tasks in Franka Kitchen. (A) and (B) show the completion rates against the wall time and sample cost. We only show the sample cost plots for agents trained on mixed and partial datasets for brevity.
            </div>
        </div>
        <div class="figure-container" style="text-align: center;">
            <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/robomimic-img_can-img_SuccessRate-page1.jpg" alt="Can Success Rate">
                    <div class="subfigure-caption" style="text-align: center;">(A) Can</div>
                </div>
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/robomimic-img_square-img_SuccessRate-page1.jpg" alt="Square Success Rate">
                    <div class="subfigure-caption" style="text-align: center;">(B) Square</div>
                </div>
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/robomimic-img_transport-img_SuccessRate-page1.jpg" alt="Transport Success Rate">
                    <div class="subfigure-caption" style="text-align: center;">(C) Transport</div>
                </div>
            </div>
            <div class="figure-container legend" style="text-align: center;">
                <img src="figs/jpgs/robomimic-img_can-img_SuccessRate_legend_crop-page1.jpg" alt="Legend4">
            </div>
            <div class="caption" style="text-align: center;">
                Success rates in visual manipulation tasks in Robomimic.
            </div>
        </div>

        <h4>2.2 Comparison with Other Diffusion RL Methods</h4>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">⚖️</span>
            ReinFlow outperforms diffusion RL baselines in stability and asymptotic performance across continuous control tasks like Ant-v0, Hopper-v2, and Walker2d-v2.
        </p>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">📊</span>
            Using consistent hyperparameters from prior work, ReinFlow demonstrates superior performance, as shown in Fig. 5(A-C).
        </p>
        <div class="figure-container" style="text-align: center;">
            <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/all_diffusion_baselines_ant-page1.jpg" alt="Diffusion RL Baselines in Ant-v0">
                    <div class="subfigure-caption" style="text-align: center;">(A) Ant-v0</div>
                </div>
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/all_diffusion_baselines_hopper-page1.jpg" alt="Diffusion RL Baselines in Hopper-v2">
                    <div class="subfigure-caption" style="text-align: center;">(B) Hopper-v2</div>
                </div>
                <div class="subfigure-3" style="max-width: 30%;">
                    <img src="figs/jpgs/all_diffusion_baselines_walker-page1.jpg" alt="Diffusion RL Baselines in Walker2d-v2">
                    <div class="subfigure-caption" style="text-align: center;">(C) Walker2d-v2</div>
                </div>
            </div>
            <div class="caption" style="text-align: center;">
                Fine-tuning locomotion tasks Ant-v0, Hopper-v2, and Walker2d-v2 with Diffusion RL baselines and ReinFlow.
            </div>
        </div>
    </section>

    <section id="design-choice">
        <h3>3. The Design Choice and Key Factors Affecting ReinFlow</h3>
        <p>We examine how pre-trained models, denoising steps, noise levels, regularization and denoising step number impact ReinFlow.</p>
        <h4>3.1 RL Provides Another Scaling Dimension</h4>
        <p class="indented-paragraph" style="font-family: Arial, sans-serif; max-width: 800px; line-height: 1.4;">
            <span style="font-size: 1.2em; margin-right: 6px;">➖ </span>
            Scaling data or inference steps: quickly plateaus.<br>
        </p>
        <p class="indented-paragraph">
            <span style="font-size: 1.2em; margin-right: 6px;">📈</span>
            Fine-tuning with RL (ReinFlow): consistently enhances performance. 
        </p>
        <div class="figure-container">
            <div class="subfigure-row">
                <div class="subfigure-3">
                    <img src="figs/jpgs/avg_episode_reward_3d_surface-page1.jpg" alt="ReFlow Policy in Hopper-v2">
                    <div class="subfigure-caption">(A) ReFlow Policy in Hopper-v2</div>
                </div>
                <div class="subfigure-3">
                    <img src="figs/jpgs/datascale_shortcut_square_success_rate_2d-page1.jpg" alt="Shortcut Policy in Square">
                    <div class="subfigure-caption">(B) Shortcut Policy in Square</div>
                </div>
                <div class="subfigure-3">
                    <img src="figs/jpgs/robomimic-img_square-img-logitbeta_SuccessRate-page1.jpg" alt="ReFlow Policy in Square">
                    <div class="subfigure-caption">(C) ReFlow Policy in Square</div>
                </div>
            </div>
            <div class="caption">
                RL provides another way of scaling apart from increasing pre-training data and inference consumption, which has a plateauing effect. The improvement is invariant of flow policy’s time distribution and is achievable at four steps in Hopper (A) and one step in Square (B, C).
            </div>
        </div>
        <h4>3.2 Flow Matching's Time Distribution</h4>
        <p>ReinFlow's performance is robust to changes in time sampling. </p>
        <p class="indented-paragraph">✅ Uniform </p>
        <p class="indented-paragraph">✅ Logit-normal </p>
        <p class="indented-paragraph">✅ Beta (slightly better for single-step fine-tuning.)</p>
        <h4>3.3 Noise Network Inputs</h4>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;" aria-hidden="true">😊</span>
            Conditioning noise on state alone works well.
        </p>
        <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
            <span style="font-size: 1.3em; margin-right: 8px;" aria-hidden="true">😄</span>
            Conditioning noise on both state and time generates more diverse actions and improves success rates.
        </p>
        <div class="figure-container">
            <div class="subfigure-row">
                <div class="subfigure-2">
                    <img src="figs/jpgs/noise_parameterization_ant-page1.jpg" alt="Noise Input's Effect in Ant-v0">
                    <div class="subfigure-caption">(A) Noise Input's Effect in Ant-v0</div>
                </div>
                <div class="subfigure-2">
                    <img src="figs/jpgs/kitchen_kitchen-partial-v0-sigma_s_t_SuccessRate-page1.jpg" alt="Noise Condition's Effect in Kitchen-partial">
                    <div class="subfigure-caption">(B) Noise Condition's Effect in Kitchen-partial-v0</div>
                </div>
            </div>
            <div class="caption">
                Conditioning on state and time yields a higher success rate than only conditioning on states.
            </div>
        </div>
        <h4>3.4 Noise Level and Exploration</h4>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">⚖️</span>
            Noise magnitude affects exploration: too little traps the policy, too much hurts execution.
        </p>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">🚀</span>
            Optimal noise levels enable significant gains, especially in complex tasks.
        </p>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">🔒</span>
            Policies become less sensitive to noise once in the correct region.
        </p>
        <h4>3.5 Regularization and Exploration</h4>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">🏅</span>
            Entropy regularization promotes exploration, while behavior cloning regularization can trap the policy and is unnecessary.
        </p>
        <p style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
            <span style="font-size: 1.3em; margin-right: 8px;">🏅</span>
            Entropy regularization outperforms Wasserstein-2 constraints used in offline RL methods like FQL.
        </p>
        <div class="figure-container">
            <div class="subfigure-row">
                <div class="subfigure-2">
                    <img src="figs/jpgs/constant_noise_level-page1.jpg" alt="Noise Level Affects Exploration in Ant-v0">
                    <div class="subfigure-caption">(A) Noise Level Affects Exploration in Ant-v0</div>
                </div>
                <div class="subfigure-2">
                    <img src="figs/jpgs/gym-state_humanoid-regularize-compare_AverageEpisodeReward-page1.jpg" alt="Regularization Affects ReinFlow in Humanoid-v3">
                    <div class="subfigure-caption">(B) Regularization Affects ReinFlow in Humanoid-v3</div>
                </div>
            </div>
            <div class="caption">
                Noise level and regularization's effect. (A) demonstrates constant noise with different standard deviation affects ReinFlow's exploration. (B) shows how entropy regularization with coefficient $\alpha$ and $W_2$ regularization with different coefficients $\beta$ influences ReinFlow.
            </div>
        </div>
        <h4>3.6 The Number of Denoising Steps</h4>
            <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0 0 12px 0;">
                <span style="font-size: 1.3em; margin-right: 8px;">📈</span>
                Increasing the number of denoising steps $K$ in ReinFlow boosts initial rewards in Franka Kitchen’s Shortcut Policy but results in rapid reward plateaus, as shown in Fig. 4(A).
            </p>
            <p class="indented-paragraph" style="text-indent: 30px; font-family: Arial, sans-serif; line-height: 1.6; margin: 0;">
                <span style="font-size: 1.3em; margin-right: 8px;">🎯</span>
                In visual manipulation tasks, lowering noise standard deviation with higher $K$ improves performance for pre-trained policies with low success rates.
            </p>
            <div class="figure-container" style="text-align: center;">
                <div class="subfigure-row" style="justify-content: center; margin-left: 0; margin-right: 0;">
                    <div class="subfigure-2" style="max-width: 80%;">
                        <img src="figs/jpgs/kitchen_kitchen-complete-v0-denoise_step_TaskCompletionRate-page1.jpg" alt="Denoising Steps in Kitchen-complete">
                        <div class="subfigure-caption" style="text-align: center;">(A) Denoising Steps in Kitchen-complete</div>
                    </div>
                </div>
                <div class="caption" style="text-align: center;">
                    Fine-tuning Shortcut Policy in Kitchen-complete-v0 at denoising steps $K=1,2,4$, averaged over three seeds (0, 42, 3407).
                </div>
            </div>
        </section>
        </section>
    </section>
</body>
</html>